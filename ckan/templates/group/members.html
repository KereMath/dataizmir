{% extends "group/edit_base.html" %}

{% block subtitle %}{{ _('Members') }} {{ g.template_title_delimiter }} {{ group_dict.display_name }} {{ g.template_title_delimiter }} {{ _('Groups') }}{% endblock %}

{% block page_primary_action %}
  {# Modern "Ãœye Ekle" butonu #}
  {% link_for _('Add Member'), named_route=group_type+'.member_new', id=group_dict.id, class_='btn btn-primary btn-new-member', icon='user-plus' %}
{% endblock %}

{% block primary_content_inner %}
<div class="member-management-container">
  <h1 class="page-heading">{{ _('Manage Members') }}</h1>
  <p class="page-description">{{ _('View, edit, or remove members from this group.') }}</p>

  <div class="member-list-card">
    <div class="member-list-header">
      <div class="user-col">{{ _('User') }}</div>
      <div class="role-col">{{ _('Role') }}</div>
      <div class="actions-col">{{ _('Actions') }}</div>
    </div>
    <ul class="member-list">
      {% if members %}
        {% for user_id, user, role in members %}
        <li class="member-item">
          <div class="user-col">
            <div class="user-info">
              <div class="user-avatar" style="background-image: url({{ h.gravatar(user.email, size=40, default='identicon') }});"></div>
              <div class="user-details">
                <a href="{{ h.url_for('user.read', id=user_id) }}" class="user-displayname">{{ user.display_name }}</a>
                <span class="user-name">@{{ user.name }}</span>
              </div>
            </div>
          </div>
          <div class="role-col">
            <span class="role-badge role-{{ role|lower }}">{{ h.roles_trans().get(role, role) }}</span>
          </div>
          <div class="actions-col">
            <div class="action-buttons">
              <a class="action-btn edit" href="{{ h.url_for(group_type + '.member_new', id=group_dict.id, user=user_id) }}" title="{{ _('Edit') }}">
                <i class="fa fa-pen-to-square"></i>
              </a>
              <a class="action-btn delete" href="{{ h.url_for(group_type + '.member_delete', id=group_dict.id, user=user_id) }}" data-module="confirm-action" data-module-content="{{ _('Are you sure you want to remove this member?') }}" title="{{ _('Remove') }}">
                <i class="fa fa-trash-can"></i>
              </a>
            </div>
          </div>
        </li>
        {% endfor %}
      {% else %}
        <li class="member-item empty">
          <p>{{ _('This group has no members.') }}</p>
        </li>
      {% endif %}
    </ul>
  </div>
</div>
{% endblock %}


{% block styles %}
  {{ super() }}
  <style>
    :root {
      --futuristic-bg: #111827;
      --futuristic-card-bg: #1f2937;
      --futuristic-border: #374151;
      --futuristic-text: #d1d5db;
      --futuristic-text-light: #9ca3af;
      --futuristic-primary: #3b82f6;
      --futuristic-primary-hover: #2563eb;
      --futuristic-danger: #ef4444;
      --futuristic-danger-hover: #dc2626;
      --futuristic-radius: 12px;
      --futuristic-shadow: 0 4px 6px -1px rgba(0,0,0,0.1), 0 2px 4px -2px rgba(0,0,0,0.1);
    }

    .btn-new-member {
      background-color: var(--futuristic-primary) !important;
      border-color: var(--futuristic-primary) !important;
      transition: all 0.2s ease-in-out;
      font-weight: 600;
      border-radius: 8px !important;
    }
    .btn-new-member:hover {
      background-color: var(--futuristic-primary-hover) !important;
      border-color: var(--futuristic-primary-hover) !important;
      transform: translateY(-2px);
      box-shadow: 0 4px 10px rgba(59, 130, 246, 0.3);
    }

    .member-management-container {
      max-width: 900px;
      margin: 2rem auto;
    }

    .page-heading {
      font-size: 2.25rem;
      font-weight: 700;
      color: var(--futuristic-bg);
      margin-bottom: 0.5rem;
    }

    .page-description {
      font-size: 1.1rem;
      color: var(--futuristic-text-light);
      margin-bottom: 2rem;
    }
    
    .member-list-card {
      background-color: #fff;
      border: 1px solid #e5e7eb;
      border-radius: var(--futuristic-radius);
      box-shadow: var(--futuristic-shadow);
      overflow: hidden;
    }

    .member-list-header {
      display: flex;
      align-items: center;
      padding: 1rem 1.5rem;
      background-color: #f9fafb;
      border-bottom: 1px solid #e5e7eb;
      font-weight: 600;
      color: #6b7280;
      font-size: 0.875rem;
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }

    .user-col { flex: 3; }
    .role-col { flex: 1; text-align: center; }
    .actions-col { flex: 1; text-align: right; }

    .member-list {
      list-style: none;
      padding: 0;
      margin: 0;
    }

    .member-item {
      display: flex;
      align-items: center;
      padding: 1rem 1.5rem;
      border-bottom: 1px solid #e5e7eb;
      transition: background-color 0.2s;
    }
    .member-item:last-child {
      border-bottom: none;
    }
    .member-item:hover {
      background-color: #f9fafb;
    }
    .member-item.empty {
      justify-content: center;
      color: var(--futuristic-text-light);
      padding: 2rem;
    }

    .user-info { display: flex; align-items: center; gap: 1rem; }
    .user-avatar { width: 40px; height: 40px; border-radius: 50%; background-size: cover; }
    .user-details { display: flex; flex-direction: column; }
    a.user-displayname { font-size: 1rem; font-weight: 600; color: var(--futuristic-bg); text-decoration: none; }
    a.user-displayname:hover { color: var(--futuristic-primary); }
    .user-name { font-size: 0.875rem; color: var(--futuristic-text-light); }
    
    .role-badge {
      display: inline-block;
      padding: 0.25rem 0.75rem;
      border-radius: 999px;
      font-size: 0.8rem;
      font-weight: 700;
      text-transform: capitalize;
    }
    .role-badge.role-admin { background-color: #fee2e2; color: #b91c1c; }
    .role-badge.role-editor { background-color: #fef3c7; color: #b45309; }
    .role-badge.role-member { background-color: #e5e7eb; color: #4b5563; }

    .action-buttons { display: flex; justify-content: flex-end; gap: 0.5rem; }
    .action-btn {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 36px;
      height: 36px;
      border-radius: 50%;
      border: 1px solid transparent;
      background-color: #e5e7eb;
      color: #4b5563;
      font-size: 1rem;
      text-decoration: none;
      transition: all 0.2s;
    }
    .action-btn.edit:hover { background-color: var(--futuristic-primary); color: #fff; border-color: var(--futuristic-primary); }
    .action-btn.delete:hover { background-color: var(--futuristic-danger); color: #fff; border-color: var(--futuristic-danger); }
  </style>
{% endblock %}